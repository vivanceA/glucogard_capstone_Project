# Glucogard

Glucogard is a mobile application designed to help manage and monitor glucose levels for diabetic patients, facilitating better communication between patients and doctors.

## Table of Contents

- [Project Title and Description](#glucogard)
- [Table of Contents](#table-of-contents)
- [Installation](#installation)
- [Running the Application](#running-the-application)
- [Key Features](#key-features)
- [Technologies Used](#technologies-used)
- [Project Structure](#project-structure)
- [Contributing](#contributing)
- [License](#license)

## Installation

To get a local copy up and running, follow these simple steps.

### Prerequisites

- Node.js (v18.x or later recommended)
- npm (comes with Node.js) or yarn
- Expo CLI
  ```sh
  npm install -g expo-cli
  ```
- Supabase Account and Project Setup:
    1. Create an account at [Supabase](https://supabase.com).
    2. Create a new project.
    3. Obtain your Project URL and `anon` key from the API settings.

### Setup

1.  **Clone the repository:**
    ```sh
    git clone <YOUR_REPOSITORY_URL>
    cd glucogard
    ```

2.  **Install NPM packages:**
    ```sh
    npm install
    ```
    or if you prefer yarn:
    ```sh
    yarn install
    ```

3.  **Configure Supabase:**
    Create a `.env` file in the root of the project (or update your environment variables directly) with your Supabase credentials. This file should be added to `.gitignore`.
    ```
    EXPO_PUBLIC_SUPABASE_URL=YOUR_SUPABASE_PROJECT_URL
    EXPO_PUBLIC_SUPABASE_ANON_KEY=YOUR_SUPABASE_ANON_KEY
    EXPO_PUBLIC_API_URL=http://<YOUR_LOCAL_IP_ADDRESS>:8000
    ```
    You will need to update `lib/supabase.ts` if you choose a different way to manage these environment variables. Currently, it expects them to be available via `process.env`.

4.  **Apply Supabase Migrations:**
    Ensure you have the Supabase CLI installed and configured.
    ```sh
    supabase login
    supabase link --project-ref <YOUR_PROJECT_ID>
    supabase db push
    ```
    Alternatively, you can run the SQL files in the `supabase/migrations` directory directly in your Supabase project's SQL editor in the correct order.

## Running the Application

1.  **Start the development server:**
    ```sh
    npm start
    ```
    or
    ```sh
    expo start
    ```
    This will open the Expo Developer Tools in your browser. You can then:
    - Run on an Android emulator/device
    - Run on an iOS simulator/device
    - Run in a web browser

## AI Engine (`/ai_engine`)

The AI engine is a Python-based FastAPI service that provides risk prediction for diabetes based on patient data.

### AI Engine Setup

1.  **Navigate to the project root directory:**
    ```sh
    cd /path/to/glucogard
    ```

2.  **Create and activate a Python virtual environment:**
    ```sh
    python3 -m venv venv
    source venv/bin/activate
    # On Windows, use: venv\Scripts\activate
    ```

3.  **Install Python dependencies:**
    ```sh
    pip install -r ai_engine/requirements.txt
    ```
    **Note:** You will need the `diabetes_model.pkl` file in the `ai_engine/` directory. This file is generated by a separate model training process and is not included in the repository.


## Web Dashboard and Research Portal Deployment

### Web Dashboard (`/web-dashboard`)
The web dashboard provides healthcare providers with:
- Patient management interface
- Real-time health analytics
- Risk assessment tools
- Population health insights

**Authentication**: Requires doctor role authentication
**Access**: Healthcare providers only

### Research Portal (`/research-portal`)
The research portal offers:
- Anonymized health data access
- Public health metrics
- Research data export (CSV)
- Interactive visualizations

**Authentication**: Public access with optional authentication for enhanced features
**Compliance**: GDPR and Rwanda Law No. 058/2021 compliant

### Deployment Steps

1. **Build for Web**:
   ```sh
   expo export --platform web
   ```

2. **Environment Variables**:
   Set up the following environment variables:
   ```
   EXPO_PUBLIC_SUPABASE_URL=your_supabase_url
   EXPO_PUBLIC_SUPABASE_ANON_KEY=your_supabase_anon_key
   EXPO_PUBLIC_WEB_DASHBOARD_URL=https://your-domain.com/web-dashboard
   EXPO_PUBLIC_RESEARCH_PORTAL_URL=https://your-domain.com/research-portal
   ```

3. **Deploy to Hosting Provider**:
   - **Vercel**: Connect your repository and deploy
   - **Netlify**: Drag and drop the `dist` folder or connect via Git
   - **Custom Server**: Upload the `dist` folder to your web server

4. **Configure Domain and SSL**:
   - Set up custom domain
   - Configure SSL certificate
   - Update CORS settings in Supabase

5. **Security Configuration**:
   - Configure authentication providers in Supabase
   - Set up Row Level Security policies
   - Implement rate limiting for API endpoints
   - Configure security headers

### Authentication for Web Dashboards

The web dashboards use a dual authentication system:

1. **Mobile App Authentication**: Uses the existing `AuthContext` for mobile users
2. **Web Dashboard Authentication**: Uses `WebAuthProvider` for web-specific authentication

**Doctor Dashboard Authentication**:
- Requires valid email/password authentication
- Automatically verifies doctor role
- Redirects unauthorized users
- Session management with automatic logout

**Research Portal Authentication**:
- Public access for viewing anonymized data
- Optional authentication for data export
- Role-based access for enhanced features

### API Endpoints

- `/web-dashboard` - Doctor dashboard API
- `/web-auth` - Web authentication API
- `/research-portal` - Research data API
- `/deployment` - Deployment status and configuration

## Key Features

- User authentication (registration and login) for patients and doctors.
- Separate dashboards for patients and doctors.
- Health risk assessment for patients.
- Patient management and analytics for doctors.
- Web dashboard for healthcare providers.
- Research portal for anonymized health data.
- Profile management.
- Location-based health recommendations.
- Research data export and analytics.

## Technologies Used

- **Frontend:**
    - React Native
    - Expo
    - TypeScript
    - Web Dashboard (React Native Web)
- **Backend & Database:**
    - Supabase (PostgreSQL, Auth, Realtime)
    - API Routes (Expo Router)
- **Styling:** (Assumed, based on typical React Native development)
- **Navigation:** React Navigation (Expo Router)
- **Deployment:** Web-compatible build system

## Project Structure

```
glucogard/
├── .gitignore
├── app.json                 # Expo configuration
├── package.json             # Project dependencies and scripts
├── tsconfig.json            # TypeScript configuration
├── app/                     # Main application code (screens, navigation)
│   ├── (tabs)/              # Tab-based navigation layout
│   ├── auth/                # Authentication screens
│   ├── chat/                # [patientId].tsx
│   ├── research-portal/     # Public research portal
│   ├── _layout.tsx          # Root layout
│   └── index.tsx            # Entry point for the app
├── assets/                  # Static assets (images, fonts)
├── components/              # Reusable UI components
│   ├── DoctorWebDashboard.tsx  # Web-optimized doctor dashboard
│   ├── WebAuthProvider.tsx     # Web authentication provider
├── context/                 # React Context API for global state
│   └── AuthContext.tsx      # Authentication state management
├── hooks/                   # Custom React hooks
├── lib/                     # Utility functions, Supabase client setup
│   ├── auth.ts              # Authentication helper functions
│   ├── research.ts          # Research data and analytics
│   └── supabase.ts          # Supabase client initialization
├── supabase/                # Supabase specific files
│   └── migrations/          # Database schema migrations
└── types/                   # TypeScript type definitions
    └── database.ts          # Types generated from Supabase schema (potentially)
```

## Contributing

Contributions are what make the open-source community such an amazing place to learn, inspire, and create. Any contributions you make are **greatly appreciated**.

If you have a suggestion that would make this better, please fork the repo and create a pull request. You can also simply open an issue with the tag "enhancement".
Don't forget to give the project a star! Thanks again!

1.  Fork the Project
2.  Create your Feature Branch (`git checkout -b feature/AmazingFeature`)
3.  Commit your Changes (`git commit -m 'Add some AmazingFeature'`)
4.  Push to the Branch (`git push origin feature/AmazingFeature`)
5.  Open a Pull Request

## License

Distributed under the MIT License. See `LICENSE.txt` for more information. (Note: You'll need to create a LICENSE.txt file if you want to include one).
